import{W as S,S as v,a as I,O as R}from"./three.module-Cdr6prlM.js";/* empty css               */import{g as T}from"./lil-gui.module.min-Vka56b52.js";import{C as D}from"./CameraTransitionManager-DEZ_Jh2g.js";import{T as b}from"./TilesRenderer-CeXRket9.js";import{T as y,I as z}from"./TiledImageSource-BrtEEhz2.js";import{U as W}from"./UpdateOnChangePlugin-CWnEQ7XL.js";import{E as A}from"./EnvironmentControls-BxHxh8we.js";import"./I3DMLoader-CCE0l15Y.js";import"./readMagicBytes-B3HEinov.js";import"./GLTFLoader-MuDEHmgM.js";import"./Ellipsoid-CuSwTtSS.js";import"./B3DMLoader-BP7KbjDP.js";import"./PNTSLoader-C1N3YT1_.js";import"./CMPTLoader-Asj2gLWV.js";import"./EllipsoidRegion-DVo7AClK.js";class E extends y{constructor(...e){super(...e),this.format=null,this.stem=null}getUrl(e,o,n){return`${this.stem}_files/${n}/${e}_${o}.${this.format}`}init(e){return this.fetchData(e,this.fetchOptions).then(o=>o.text()).then(o=>{const n=new DOMParser().parseFromString(o,"text/xml");if(n.querySelector("DisplayRects")||n.querySelector("Collection"))throw new Error("DeepZoomImagesPlugin: DisplayRect and Collection DZI files not supported.");const m=n.querySelector("Image"),d=m.querySelector("Size"),g=parseInt(d.getAttribute("Width")),h=parseInt(d.getAttribute("Height")),u=parseInt(m.getAttribute("TileSize")),f=parseInt(m.getAttribute("Overlap")),x=m.getAttribute("Format");this.format=x,this.stem=e.split(/\.[^.]+$/g)[0];const{tiling:p}=this,P=Math.ceil(Math.log2(Math.max(g,h)))+1;p.flipY=!0,p.pixelOverlap=f,p.generateLevels(P,1,1,{tilePixelWidth:u,tilePixelHeight:u,pixelWidth:g,pixelHeight:h})})}}class L extends z{constructor(...e){super(...e),this.name="DZI_TILES_PLUGIN",this.imageSource=new E}async loadRootTileSet(){const{tiles:e,imageSource:o}=this;let n=e.rootURL;return e.invokeAllPlugins(m=>n=m.preprocessURL?m.preprocessURL(n,null):n),await o.init(n),this.getTileset(n)}}let a,l,s,t,r;const c={errorTarget:1,renderScale:1,orthographic:!1};U();C();function U(){s=new S({antialias:!0}),s.setPixelRatio(window.devicePixelRatio),s.setSize(window.innerWidth,window.innerHeight),s.setClearColor(1118481),document.body.appendChild(s.domElement),l=new v,r=new D(new I(60,window.innerWidth/window.innerHeight,.001,1e4),new R(-1,1,1,-1,0,4e3)),r.camera.position.set(0,0,150),r.camera.lookAt(0,0,0),r.autoSync=!1,r.addEventListener("camera-change",({camera:e,prevCamera:o})=>{t.deleteCamera(o),t.setCamera(e),a.setCamera(e)}),t=new b("https://openseadragon.github.io/example-images/duomo/duomo.dzi"),t.registerPlugin(new L({center:!0})),t.registerPlugin(new W),t.fetchOptions.mode="cors",t.lruCache.minSize=900,t.lruCache.maxSize=1300,t.errorTarget=1,t.setCamera(r.camera),l.add(t.group),a=new A(l,r.camera,s.domElement),a.minZoomDistance=2,a.minDistance=.01,a.maxDistance=1e3,a.cameraRadius=0,a.enableDamping=!0,a.fallbackPlane.normal.set(0,0,1),a.up.set(0,0,1),w(),window.addEventListener("resize",w,!1);const i=new T;i.add(c,"orthographic").onChange(e=>{r.fixedPoint.copy(a.pivotPoint),r.syncCameras(),a.adjustCamera(r.perspectiveCamera),a.adjustCamera(r.orthographicCamera),r.toggle()}),i.add(c,"errorTarget",0,100).onChange(()=>{t.getPluginByName("UPDATE_ON_CHANGE_PLUGIN").needsUpdate=!0}),i.add(c,"renderScale",.1,1,.05).onChange(e=>s.setPixelRatio(e*window.devicePixelRatio)),i.open()}function w(){const{perspectiveCamera:i,orthographicCamera:e}=r,o=window.innerWidth/window.innerHeight;e.bottom=-40,e.top=40,e.left=-40*o,e.right=40*o,e.updateProjectionMatrix(),i.aspect=o,i.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight)}function C(){requestAnimationFrame(C),a.enabled=!r.animating,a.update(),r.update();const i=r.camera;i.updateMatrixWorld(),t.errorTarget=c.errorTarget,t.setCamera(i),t.setResolutionFromRenderer(i,s),t.update(),s.render(l,i)}
